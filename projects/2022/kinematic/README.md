# Recovering surface mass balance from kinematic observations

## reassurance

The point of the project is not to reach a particular destination!  It is to _help you learn fast from wherever you currently are_.  So please be honest with yourself about what you don't know, and please do ask about it!  Another student may know more programming than you, or have seen more differential equations, or have more glaciers background, or data-manipulation skills, or whatever.  That is irrelevant to my goal.  I just want to help you move forward as far as possible in one intense week.  Forward progress must be from things _you_ do understand into things _you_ do not yet understand!

## description

PROJECT 10: Recovering surface mass balance from kinematic observations

ADVISOR: Ed Bueler

DESCRIPTION: Remote observations of glaciers using visible and radar imaging allow increasingly-routine determination of ice surface elevation and ice surface velocity.  On the other hand, surface mass balance (SMB) rates can be hard to observe remotely, for instance in ablation areas and/or firn areas with ice lenses.  The surface kinematical equation (SKE) is worth understanding in this regard, in addition to its application to modeling glacier evolution.  We will use the SKE to invert time-dependent synthetic observations to extract SMB, a feat attempted before (e.g. Gudmundsson & Bauder, 1999).  A newly-discovered form of the SKE makes the topic worth a second look.  Simplified 1D geometry and the linear nature of the problem make it achievable in a week-long project.

SOFTWARE REQUIREMENTS: Matlab or Octave or Python/numpy, _running locally on your machine_.

REQUIRED STUDENT BACKGROUND: Exposure to differential equations and linear algebra.

## references and reading

Three reference PDFs are available in the current directory:

  * E. Bueler (2022a). *A synthetic, time-dependent glacier for testing surface kinematical inversion*, unpublished.  _This is the `synglac.pdf` note mentioned below._
  * FIXME: I WILL PUT IT IN. E. Bueler (2022b). *A new kinematical conservation law for glaciers*, unpublished.   _A draft of a paper I am writing._
  * G. H. Gudmundsson & A. Bauder (1999). *Towards an indirect determination of the mass‐balance distribution of glaciers using the kinematic boundary condition*, Geografiska Annaler: Series A, Physical Geography, 81(4), 575-583.  _Shows inversion of the SKE, and addresses how to recover the vertical surface velocity $w|_s$._

## getting started

The Python script `glacier.py` computes all the relevant surface fields of a synthetic, time-varying glacier.  The PDF `synglac.pdf`, generated by the LaTeX files in the `doc/` directory, shows the formulas used in this case.

My suggestion for Project 10 is that you use `glacier.py` to generate an initial test of the inversion of the kinematic conservation law (KCL), a new form of the surface kinematical equation (SKE).  The following paragraphs are documentation to help you do that.

### discretizing space-time

The brief sketch in `synglac.pdf` shows that the KCL gives an integral equation with the unknown lumped CMB $\tilde a(t,x)$ on the left; see equation (3).

This integral equation becomes a linear system if we discretize.  In particular, suppose the time-space rectangle $[t_0,t_1]\times[x_0,x_1]$ is divided by grid spaces $\Delta t$ and $\Delta x$, giving $J$ intervals in time and $K$ intervals in space.  Suppose we represent the unknown field $\tilde a$ by its $n = JK$ values at the centers of the cells which have dimensions $\Delta t \times \Delta x$

### evaluating formulas from the synthetic glacier code

### overdetermined systems, least squares, and using the SVD

Following the brief sketch in `synglac.pdf`, I propose that you build an overdetermined linear system from discretizing $t,x$ as described above.

An overdetermined system has $m$ equations and $n$ unknowns where $m>n$.  For example, if the equation is

$$A x = b$$

then $x$ is a column vector with $n$ entries and $b$ is a column vector with $m$ entries, and $A$ is a matrix with $m$ rows and $n$ columns.  The equation "$Ax=b$" should really be in quotes because we don't expect an exact solution.  Instead we want the least-squares solution where we find $x$ so that $Ax$ and $b$ are as close to being the same vector as possible, that is, so that the norm of the difference $\|Ax-b\|$ is small.  Since norms are usually computed by summing the squares of the entries, followed by square root, this is the least-squares idea.

The script `demos/lstsq_demo.py` sets up a system of $m=3$ equations and $n=2$ unknowns and it solves it by using the `lstsq()` function in `scipy.linalg`.  Please understand this example before proceeding.

Optionally you may want to understand the singular value decomposition (SVD), which is one way to handle least-squares problems.  See `demos/svd_demo.py`.
